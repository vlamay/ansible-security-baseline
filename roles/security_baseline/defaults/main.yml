---
# Default variables for security_baseline role
# Override these in group_vars, host_vars, or playbook vars

# =============================================================================
# Environment Settings
# =============================================================================
security_baseline_environment: development  # development, staging, production

# =============================================================================
# SSH Hardening Configuration
# =============================================================================
security_baseline_ssh_port: 22
security_baseline_permit_root_login: "no"
security_baseline_password_authentication: "no"
security_baseline_pubkey_authentication: "yes"
security_baseline_max_auth_tries: 3
security_baseline_login_grace_time: 30
security_baseline_x11_forwarding: "no"
security_baseline_permit_empty_passwords: "no"
security_baseline_client_alive_interval: 300
security_baseline_client_alive_count_max: 2

# SSH Allowed Users (empty means all users allowed)
security_baseline_allow_users: []
# security_baseline_allow_users:
#   - deploy
#   - ansible

# SSH Key Exchange Algorithms (modern and secure)
security_baseline_ssh_kex_algorithms:
  - curve25519-sha256@libssh.org
  - diffie-hellman-group-exchange-sha256
  - diffie-hellman-group16-sha512
  - diffie-hellman-group18-sha512

# SSH Ciphers (strong encryption only)
security_baseline_ssh_ciphers:
  - chacha20-poly1305@openssh.com
  - aes256-gcm@openssh.com
  - aes128-gcm@openssh.com
  - aes256-ctr
  - aes192-ctr
  - aes128-ctr

# SSH MACs (message authentication codes)
security_baseline_ssh_macs:
  - hmac-sha2-512-etm@openssh.com
  - hmac-sha2-256-etm@openssh.com
  - hmac-sha2-512
  - hmac-sha2-256

# SSH Host Key Algorithms
security_baseline_ssh_host_key_algorithms:
  - ssh-ed25519
  - rsa-sha2-512
  - rsa-sha2-256

# =============================================================================
# Firewall Configuration (UFW)
# =============================================================================
security_baseline_configure_firewall: true
security_baseline_firewall_default_policy: deny
security_baseline_firewall_allowed_ports:
  - 22  # SSH
# Add more ports as needed:
#   - 80   # HTTP
#   - 443  # HTTPS

# Custom firewall rules (advanced)
security_baseline_firewall_custom_rules: []
# security_baseline_firewall_custom_rules:
#   - { rule: 'allow', port: '8080', proto: 'tcp' }
#   - { rule: 'allow', from_ip: '10.0.0.0/8', port: '3306' }

# =============================================================================
# Auditd Configuration
# =============================================================================
security_baseline_enable_auditd: true
security_baseline_audit_critical_files: true
security_baseline_audit_privileged_commands: true
security_baseline_audit_network_changes: true
security_baseline_audit_user_changes: true

# =============================================================================
# Fail2ban Configuration
# =============================================================================
security_baseline_enable_fail2ban: true
security_baseline_fail2ban_bantime: 600        # 10 minutes
security_baseline_fail2ban_findtime: 600       # 10 minutes
security_baseline_fail2ban_maxretry: 5
security_baseline_fail2ban_backend: systemd
security_baseline_fail2ban_destemail: "root@localhost"
security_baseline_fail2ban_sender: "fail2ban@localhost"
security_baseline_fail2ban_action: "action_"   # action_, action_mw, action_mwl

# Fail2ban jails to enable
security_baseline_fail2ban_jails:
  - sshd
# Add more jails:
#   - nginx-http-auth
#   - apache-auth

# =============================================================================
# System Hardening (sysctl)
# =============================================================================
security_baseline_sysctl_hardening: true

# Network security
security_baseline_disable_ip_forwarding: true
security_baseline_enable_syn_cookies: true
security_baseline_enable_rp_filter: true
security_baseline_disable_source_routing: true
security_baseline_disable_send_redirects: true
security_baseline_disable_accept_redirects: true
security_baseline_ignore_icmp_broadcasts: true
security_baseline_log_martians: true

# Kernel hardening
security_baseline_enable_aslr: true
security_baseline_restrict_dmesg: true
security_baseline_restrict_kernel_pointers: true
security_baseline_restrict_core_dumps: true

# =============================================================================
# Password Policy Configuration
# =============================================================================
security_baseline_configure_password_policy: true
security_baseline_password_min_length: 14
security_baseline_password_min_classes: 3      # Number of character classes required
security_baseline_password_max_age: 90         # Days
security_baseline_password_min_age: 7          # Days
security_baseline_password_warn_age: 14        # Days before expiry to warn
security_baseline_password_history_remember: 5 # Remember last N passwords

# =============================================================================
# Logging Configuration
# =============================================================================
security_baseline_configure_logging: true
security_baseline_remote_syslog_server: ""     # Empty means local only
security_baseline_log_retention_days: 90

# =============================================================================
# Automatic Security Updates
# =============================================================================
security_baseline_enable_auto_updates: true
security_baseline_auto_update_security_only: true
security_baseline_auto_reboot: false
security_baseline_auto_reboot_time: "02:00"

# =============================================================================
# Additional Security Packages
# =============================================================================
security_baseline_install_security_packages: true
security_baseline_security_packages:
  - auditd
  - audispd-plugins
  - fail2ban
  - ufw
  - unattended-upgrades
  - apt-listchanges
  - libpam-pwquality
  - acl
  - rkhunter
  - chkrootkit

# =============================================================================
# Optional Features
# =============================================================================
security_baseline_disable_usb_storage: false
security_baseline_disable_bluetooth: false
security_baseline_configure_aide: false        # Advanced Intrusion Detection Environment
security_baseline_configure_apparmor: false    # AppArmor profiles

# =============================================================================
# Backup and Recovery
# =============================================================================
security_baseline_backup_configs: true
security_baseline_backup_directory: /var/backups/security_baseline
